# Discrete Fourier Transform

Consider an infinite 1D chain of evenly separated sites. The distance between two nearest neighbors is $a$. The $n$th site is at the position

$$
x_n = na \quad (n \in \mathbb{Z})
$$

The we apply a function $f(x): \R \to \C$ on the sites of the chain, and obtain a sequence of function values:

$$
f_n \equiv f(x_n)
$$

The function may represent some physical quantities of the site, such as mass, displacement, field strength, etc. 

## Boundary Conditions

As usually the case in practice, one can impose the **periodic/anti-periodic boundary condition (PBC/ABC)** on the function $f(x)$: 

$$
f(x + L) = \pm f(x), \quad L = Na \quad (N \in \mathbb{N}_+)
$$

Then all useful information is included in any interval containing $N$ consecutive sites, since the sequence $\{f(x_n)\}$ repeats itself every $N$ sites (with alternating signs for ABC):

$$
f_{n+N} = \pm f_n \quad \text{or} \quad
f(x_{n+N}) = \pm f(x_n)
$$

<div class="remark">

*Remark*: The ABC with period $L$ is a special case of PBC with period $2L$, but of course there are redundant information in the doubled period.

</div><br>

## Site-Labelling Conventions

The sites within one period can be labelled by any $N$ consecutive integers. Two common choices are:

- The *natural* convention: labelling by natural numbers
    
    $$
    n \in [0, N) \cap \mathbb{Z} 
    = \{0, 1, ..., N-1\}
    $$

- The *symmetric* convention: labels are symmetrized around the origin

$$
n \in \left[-\frac{N}{2}, \frac{N}{2} \right) \cap \mathbb{Z} 
= \begin{cases}
    \{ -\frac{N}{2}, ..., \frac{N}{2}-1 \}
    & N \, \text{even}
    \\
    \{ -\frac{N-1}{2}, ..., \frac{N-1}{2} \}
    & N \, \text{odd}
\end{cases}
$$

For notational convenience, below we use the natural convention unless otherwise stated.

## DFT and Translation Group

The $N$ values $\{f(x_n)\}$ within one period into a column vector in the vector space $\mathbb{C}^N$ (for notational convenience, choose $n=0,...,N-1$):

$$
f = [f(x_0), ..., f(x_{N-1})]^\mathsf{T} \in \mathbb{C}^N
$$

Then $f(x_n)$ can be regarded as the component of $f$ along the standard basis vectors $e_n$

$$
f = \sum_n f_n e_n = \sum_n f(x_n) e_n
$$

The **discrete Fourier transform** of $\{f(x_n)\}$ is the component of the vector $f$ under a *new set of orthonormal basis vectors* $\{u_m\}$:

$$
f = \sum_m \tilde{f}_m u_m
$$

<div class="remark">

*Remark*: Let $U_{nm}$ be the component of $u_m$ along the standard basis $e_n$, i.e. 

$$
u_m = \sum_n U_{nm} e_n
$$

The collection of all $U_{nm}$'s is the matrix $U$ of change of basis. Since both $\{u_m\}, \{e_n\}$ are orthonormal basis, the matrix $U$ is *unitary*.

</div><br>

How to choose the new basis vectors $u_m$? This is done from the group theory point of view. 

### Periodic Boundary Condition

The $N$-site lattice with PBC is invariant under translations by an integer number of sites; the PBC translation group $T_P$ is a *cyclic group* of order $N$, generated by the element $t$ (translation by one site):

$$
T_P = \{1,t,...,t^{N-1}\} \cong \mathbb{Z}_N
\quad (t^N = 1)
$$

The action of the element $t$ on the vector $f$ is cyclicly permuting the components of $f$: under the standard basis

$$
t (f_0,...,f_{N-1}) = (f_1,...,f_{N-1},f_0)
\quad \text{or} \quad
(tf)_n = f_{n+1}
$$

Since irreducible representations of cyclic groups are all 1D, the element $t$ can be directly represented by the $N$th root of 1:

$$
t^N = 1 \ \Rightarrow \ 
t = e^{2m\pi i/N} = e^{ik_m a}, \quad
k_m \equiv \frac{2m\pi}{L}
$$

- The representations are labelled by $N$ consecutive integers $m$; usually the symmetric convention is used:

    $$
    m \in \bigg[-\frac{N}{2}, \frac{N}{2} \bigg) \cap \mathbb{Z}
    \ \Rightarrow \ 
    k_m \in \bigg[-\frac{\pi}{a}, \frac{\pi}{a} \bigg)
    $$

- $k_m$ is called the **momentum** corresponding to the $m$th irreducible representation. The new components $\tilde{f}_m$ will now be written as $f(k_m)$:
    
    $$
    f = \sum_m f(k_m) u_m
    $$

The relation between the basis vectors $\{u_m\}$ and the symmetry group $T_A$ is:

<div class="result">
<center>
<b>

$u_m$ is the basis of the $m$th irreducible representation of $T_A$.

</b>
</center>
</div><br>

Mathematically, this means that the action of $t$ on $u_m$ is

$$
t u_m = e^{ik_m a} u_m
$$

Define for convenience $u_{mN}=u_{m0}$; then

$$
\begin{gathered}
    (tu_m)_n = U_{n+1,m} = e^{ik_m a} U_{nm}
    \\[0.4em] \Rightarrow \ 
    U_{nm} = U_{0m} e^{ik_m na} = U_{0m} e^{ik_m x_n}
\end{gathered} 
\quad (n = 0,...,N-1)
$$

The expression of $U_{nm}$ is still correct if we shift the range of $n$ by an integer. The component $U_{0m}$ is a normalization and can be uniquely fixed up to a phase factor; usually it is just set to be real. By the orthogonality between the vectors $\{u_m\}$

$$
\begin{align*}
    u^\dagger_{m'} u_m &= \sum_n u^{*}_{nm'} U_{nm} 
    = U_{0m'}^* U_{0m} \sum_n e^{i(k_m-k_{m'})x_n}
    \\
    &= U_{0m'}^* U_{0m} N \delta_{mm'}
    \overset{!}{=} \delta_{mm'}
    \\[0.4em]
    &\Rightarrow \  
    U_{0m} = \frac{1}{\sqrt{N}}
    \ \Rightarrow \ 
    \boxed{
        U_{nm} = \frac{1}{\sqrt{N}} e^{ik_m x_n}
    }
\end{align*}
$$

<div class="remark">

*Remark*: In terms of $x_n, k_m$, the unitarity of the change-of-basis matrix $U$ implies the following orthogonal relations (both can be proved straightforwardly)

$$
\begin{align*}
    \frac{1}{N} \sum_m e^{ik_m (x_{n'} - x_n)} &= \delta_{nn'}
    &\quad &(x\ \text{orthogonality})
    \\
    \frac{1}{N} \sum_n e^{i(k_m - k_{m'}) x_n} &= \delta_{mm'}
    &\quad &(k\ \text{orthogonality})
\end{align*}
$$

</div><br>

Combining these results, we obtain the DFT formula (the relation between the new components $f(k_m)$ and the old components $f(x_n)$):

<div class="result">

**Discrete Fourier transform with periodic boundary condition:**

$$
f(x_n) = \sum_m f(k_m) U_{mn}
= \frac{1}{\sqrt{N}} \sum_m f(k_m) e^{i k_m x_n}
$$

The momenta $k_m$ are given by

$$
k_m = \frac{2m\pi}{L}, \quad
m \in \bigg[-\frac{N}{2}, \frac{N}{2} \bigg) \cap \mathbb{Z}
$$

</div><br>

### Anti-Periodic Boundary Condition

The ABC translation group $T_A$ is different from its PBC counterpart. Introduce the element $\tilde{t}$ (**twisted translation** by one site); its action on a vector $f$ is (under the standard basis):

$$
\tilde{t} (f_0,...,f_{N-1})
= (f_1,...,f_{N-1},-f_0)
$$

This element has order $2N$ (i.e. $\tilde{t}^{2N}=1$). The group $T_A$ is then a cyclic group of order $2N$ generated by $\tilde{t}$:

$$
T_A = \{1, \tilde{t}, ..., \tilde{t}^{2N-1}\} \cong \mathbb{Z}_{2N}
$$

The representations are labelled by the momenta ($L = Na$)

$$
k_m = \frac{2m\pi}{2L} = \frac{m\pi}{L},
\quad m \in [-N,N) \cap \mathbb{Z}
$$

However, the vector $f \in \mathbb{C}^N$ can only realize half of the irreducible representations due to dimension restrictions. Note that the action of $\tilde{t}^N$ on vector $f$ is

$$
\tilde{t}^N f = -f
$$

This is *independent of the choice of basis vectors*; thus $\tilde{t}^N$ must be represented by $-1$:

$$
e^{ik_m Na} = -1 \ \Rightarrow\ 
m \ \text{is odd}
$$

Therefore, we redefine $m$ and write the allowed momenta as

<div class="result">

**Allowed momenta for anti-periodic boundary condition:**

$$
k_m = \frac{(2m+1)\pi}{L}, \quad
m \in \bigg[-\frac{N}{2}, \frac{N}{2} \bigg) \cap \mathbb{Z}
$$

</div><br>

The DFT formula is the same as the PBC case, except this change of allowed values of $k_m$. 

## Alternative Convention

Another commonly used definition of the matrix $U$ is 

$$
U_{mn} = e^{-ik_m x_n}, \quad 
(U^{-1})_{nm} = \frac{1}{N} e^{ik_m x_n}
$$

Then the DFT formulas become

$$
f(k_m) = \sum_n e^{-i k_m x_n} f(x_n), \quad
f(x_n) = \frac{1}{N} \sum_m e^{i k_m x_n} f(k_m)
$$

This convention is convenient in deriving the continuum limit expressions. 
